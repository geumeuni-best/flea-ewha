<!-- 리뷰 조회 화면 -->

{% extends "index.html" %}

{% block head_extra %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/review.css') }}">
<script src="{{ url_for('static', filename='js/review.js') }}" defer></script>
{% endblock head_extra %}

{% block section %}
<section class="review-section" aria-labelledby="review-title">
  <div class="product-grid-container">
    <h1 id="review-title" class="review-title">전체 리뷰 목록</h1>

    {% if reviews %}
      {% for r in reviews %}
      <div class="product-item" onclick="location.href='{{ url_for('review_detail', item_name=r.item_name, review_id=r.review_id) }}'">
        
        {# 리뷰 이미지 있으면 보여주기 #}
        {% if r.img_path %}
          <img src="{{ url_for('static', filename='image/' ~ r.img_path.split('/')[-1]) }}" alt="{{ r.item_name }}">
        {% else %}
          <img src="{{ url_for('static', filename='image/no_image.png') }}" alt="no_image">
        {% endif %}

        <p class="product-name">{{ r.item_name }}</p>
        <p class="review-link">
          <a href="{{ url_for('review_detail', item_name=r.item_name, review_id=r.review_id) }}">
            {{ r.title }}
          </a>
        </p>
      </div>
      {% endfor %}
    {% else %}
      <p>등록된 리뷰가 없습니다.</p>
    {% endif %}
  </div>
  
  {% if page_count > 1 %}
  <div class="pagination">
    {% if page > 0 %}
      <a href="{{ url_for('view_review', page=page-1) }}">&lt; Previous</a>
    {% else %}
      <span>&lt; Previous</span>
    {% endif %}

    <div class="page-numbers">
      {% for i in range(page_count) %}
        {% if i == page %}
          <a href="{{ url_for('view_review', page=i) }}" class="active">{{ i + 1 }}</a>
        {% else %}
          <a href="{{ url_for('view_review', page=i) }}">{{ i + 1 }}</a>
        {% endif %}
      {% endfor %}
    </div>

    {% if page < page_count - 1 %}
      <a href="{{ url_for('view_review', page=page+1) }}">Next &gt;</a>
    {% else %}
      <span>Next &gt;</span>
    {% endif %}
  </div>
  {% endif %}
</section>
{% endblock section %}
